<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.soomjd.soomjan.jandi.model.dao.JandiMapper">
    
    <resultMap type="com.soomjd.soomjan.jandi.model.dto.JandiDTO" id="jandiResultMap">
    	<id column="EMAIL" property="email"/>
    	<result column="NICKNAME" property="nickName"/>
    	<result column="CAREER" property="career"/>
    	<result column="INTRO" property="intro"/>
    	<result column="PROFILE_PATH" property="profile_path"/>
    	<result column="ENROLL_DATE" property="enroll_date"/>
    	<result column="ACCOUNT" property="account"/>
    	<result column="BANK" property="bank"/>
    	<result column="ACC_NAME" property="acc_name"/>
    </resultMap>
    
    <resultMap type="com.soomjd.soomjan.jandi.model.dto.ClassesDTO" id="classesResultMap">
    	<id column="CLASS_CODE" property="classCode"/>
    	<result column="CREATE_DATE" property="createDate"/>
    	<result column="CONTENTS" property="contents"/>  
    	<result column="TAG" property="tag"/>  
    	<result column="CATEGORY_CODE" property="categoryCode"/>
    	<result column="EMAIL" property="email"/>
    	<result column="BOARD_TYPE" property="boardType"/>    
    	<result column="VIEWS" property="view"/>    	
    	<result column="MAX_COUNT" property="maxCount"/>    	
    	<result column="TITLE" property="title"/>    	
    	<result column="PRICE" property="price"/>    	
    	<result column="IS_DELETED" property="isDeleted"/>
    	<result column="FILE_PATH" property="filePath"/>
    	<result column="ORG_FILE_PATH" property="orgFilePath"/>
    </resultMap>
    
    <select id="selectJandi" resultMap="jandiResultMap">
    	SELECT JAN.EMAIL
			 , JAN.NICKNAME
			 , JAN.CAREER
			 , JAN.INTRO
			 , JAN.PROFILE_PATH
			 , JAN.ENROLL_DATE
			 , JAN.ACCOUNT
			 , JAN.BANK
			 , JAN.ACC_NAME
		FROM JANDI_TBL JAN
	   WHERE JAN.EMAIL = #{ email }
    </select>
    
    <select id="selectClassCodeList" resultType="hashmap">
    	SELECT 
    		   CLASS_CODE
    		 , TITLE
    	  FROM CLASS_TBL
    	 WHERE EMAIL = #{ email }
    </select>
    
    <update id="updateProfileImage">
    	UPDATE 
    	       JANDI_TBL
    	   SET PROFILE_PATH=#{savedName}
    	 WHERE EMAIL= #{email} 
    
    
    </update>

    <select id="selectCategoryList" resultType="hashmap">
    	SELECT * FROM CATEGORY_TBL
    </select>
    
    <update id="updateIntro">
    	UPDATE
    		   JANDI_TBL
    	   SET CAREER=#{intro.career},
    	       INTRO=#{intro.introduce}
    	 WHERE EMAIL=#{member.email}         
    
    
    </update>
    
    <select id="selectClassesList" resultType="String">
    	SELECT 
    		   TITLE
    	  FROM CLASS_TBL
    	 WHERE EMAIL=#{email} 		   
    </select>
    
    <select id="selectClassesCode" resultType="_int">
    	SELECT 
    	       CLASS_CODE
    	  FROM CLASS_TBL
    	 WHERE TITLE=#{myClass}      
    </select>
    
    
    
    <insert id="insertAd">
    	INSERT 
    	  INTO AD_TBL
    	(
    	  AD_CODE
    	, AD_CONTENTS
    	, IMG_PATH
    	, CLASS_CODE
    	, START_DATE
    	, ORG_IMG_PATH
    	
    	)  
    	VALUES
    	(
    	  SEQ_AD_TBL.NEXTVAL
    	, #{ adContents }
    	, #{ savedName }
    	, #{ classCode }
    	, NULL
    	, #{ originFileName }
    	  	
    	)
    	
    	
    </insert>

	<select id="selectClasses" resultMap="classesResultMap">
		SELECT 
			   CLASS_CODE
			 , CREATE_DATE
			 , CONTENTS
			 , TAG
			 , CATEGORY_CODE
			 , EMAIL
			 , BOARD_TYPE
			 , VIEWS
			 , MAX_COUNT
			 , TITLE
			 , PRICE
			 , IS_DELETED
			 , FILE_PATH
			 , ORG_FILE_PATH
		  FROM CLASS_TBL
		 WHERE EMAIL=#{ email } 	   	
	
	</select>

</mapper>